//listForm.tmpl

// The master template for the ListForm classes

// Variables used below
var dbkey = strings.Title(dd.DbKey)
var title  = dbkey + t.GoName
var formName = title + "ListForm"
var formPath = path.Join("/goradd/form/",dd.DbKey,t.GoName + "List")

{{
package form

// Code generated by goradd. DO NOT EDIT, since your changes will be lost the next time you generate code.
// To modify this form and preserve the changes, move this file to a different location,
// like the goradd-project/web/form directory, and also change the {{= title }}EditPath const below
// to a different path.

import (
    "github.com/goradd/goradd/pkg/page"
    "goradd-project/gen/{{dd.DbKey}}/panel"
    "goradd-project/control"
    "context"
    "github.com/goradd/goradd/pkg/page/action"
    "fmt"
)

// {{= title }}ListPath specifies the URL that will access this form.
const {{= title }}ListPath = "{{= formPath }}"
// {{= title }}ListID is the html id to use in the html form object.
const {{= title }}ListID = "{{= formName }}"

// The {{= formName }} is a form wrapper for the corresponding edit panel.
// To edit it, make a copy and move it out of this package and into another
type {{= formName }} struct {
    control.FormBase
}

func (f *{{= formName }})Init(ctx context.Context, id string) {
    f.FormBase.Init(ctx, id)

	f.AddRelatedFiles()
	f.createControls(ctx)
}

// Run is called by the framework before the page is operated on, either through Ajax or Server calls.
// This is a good place to do anything that needs to happen before doing any of your actions or drawing,
// like checking if the user is authorized to access the page.
func (f *{{= formName }})Run(ctx context.Context) (err error) {

    // If you are authorizing the current user, do that here
    // if !authorized() {
	//	return page.NewFrameworkError(page.FrameworkErrNotAuthorized)
    //}

	return
}

// AddRelatedFiles is called by the framework to add javascript, css, and other files that the form
// will rely on.
func (f *{{= formName }}) AddRelatedFiles() {
    f.FormBase.AddRelatedFiles()

    // Add additional javascript, css and other files here
}

func (f *{{= formName }}) createControls(ctx context.Context) {
	panel.New{{= t.GoName }}ListPanel(ctx, f, "list-panel")
}


// LoadControls is called by the framework after creating the form.
// It is the place to load up the form controls with data after the form has been created.
func (f *{{= formName }}) LoadControls(ctx context.Context) {
	f.PushLocation(ctx)
	panel.Get{{= t.GoName }}ListPanel(f, "list-panel").Load(ctx)
}


// init functions are called once when the web server first starts up.
func init() {
	page.RegisterForm({{= title }}ListPath,  &{{= formName }}{}, {{= title }}ListID)
}


}}

